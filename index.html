<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Foodie — Online Food Ordering Demo</title>
<style>
  :root{
    --bg:#f6f7fb; --card:#ffffff; --accent:#ff6b35; --muted:#6b7280;
    --glass: rgba(255,255,255,0.6);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#111;background:var(--bg);-webkit-font-smoothing:antialiased}
  header{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;background:linear-gradient(90deg,#fff,#fbfbff);box-shadow:0 1px 0 rgba(0,0,0,0.04);position:sticky;top:0;z-index:10}
  header h1{margin:0;font-size:1.125rem;color:#111}
  .container{display:grid;grid-template-columns:320px 1fr 360px;gap:1rem;padding:1rem;max-width:1200px;margin:1rem auto}
  @media (max-width:1100px){ .container{grid-template-columns:1fr; padding:0.5rem} .right-col{order:3} }
  /* Left: restaurants */
  .card{background:var(--card);border-radius:12px;padding:1rem;box-shadow:0 6px 18px rgba(16,24,40,0.06)}
  .search{display:flex;gap:.5rem;margin-bottom:.75rem}
  .search input{flex:1;padding:.5rem .75rem;border-radius:8px;border:1px solid #e6e9ef}
  .restaurant{display:flex;align-items:center;gap:.75rem;padding:.6rem;border-radius:8px;border:1px solid transparent;cursor:pointer}
  .restaurant:hover{background:#f8f9ff}
  .rest-thumb{width:56px;height:56px;border-radius:8px;flex-shrink:0;background:linear-gradient(180deg,#ffd9cc,#ffecdf);display:flex;align-items:center;justify-content:center;font-weight:600;color:#8a2b0b}
  .rest-meta{flex:1}
  .rest-name{font-weight:600}
  .rest-sub{font-size:.875rem;color:var(--muted)}
  /* Middle: menu area */
  .menu-area{min-height:60vh}
  .menu-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem}
  .menu-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem}
  .dish{border-radius:10px;padding:.75rem;background:linear-gradient(180deg,#fff,#fff);display:flex;flex-direction:column;gap:.5rem;border:1px solid #eef1f6}
  .dish .title{display:flex;justify-content:space-between;align-items:center;font-weight:600}
  .dish p{margin:0;color:var(--muted);font-size:.9rem}
  .dish .controls{display:flex;justify-content:space-between;align-items:center;margin-top:.5rem}
  button{background:var(--accent);border:0;color:#fff;padding:.45rem .75rem;border-radius:8px;cursor:pointer}
  button.secondary{background:#eef1f6;color:#111}
  /* Right: cart */
  .cart{position:sticky;top:96px}
  .cart h3{margin-top:0}
  .cart-item{display:flex;align-items:center;justify-content:space-between;padding:.5rem 0;border-bottom:1px dashed #eef1f6}
  .qty{display:inline-flex;align-items:center;gap:.25rem}
  .small{font-size:.9rem;color:var(--muted)}
  .total-row{display:flex;justify-content:space-between;font-weight:700;padding-top:.75rem}
  .checkout{margin-top:.75rem;display:flex;gap:.5rem;flex-direction:column}
  .link{background:none;border:0;color:var(--accent);cursor:pointer}
  /* modals */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.35);display:none;align-items:center;justify-content:center;z-index:50}
  .modal{background:var(--card);padding:1rem;border-radius:12px;width:min(720px,95%);box-shadow:0 20px 50px rgba(2,6,23,0.3)}
  .modal.show{display:block}
  .row{display:flex;gap:.5rem;align-items:center}
  .spacer{flex:1}
  input[type="text"], input[type="email"], input[type="password"], select{padding:.5rem .6rem;border-radius:8px;border:1px solid #e6e9ef;width:100%}
  .badge{font-size:.75rem;padding:.25rem .5rem;border-radius:6px;background:#f1f5f9}
  footer{padding:1rem;text-align:center;color:var(--muted);font-size:.85rem}
  /* order tracking */
  .track-steps{display:flex;flex-direction:column;gap:.5rem;margin-top:.5rem}
  .step{display:flex;gap:.75rem;align-items:center}
  .dot{width:12px;height:12px;border-radius:50%;background:#e6e9ef;flex-shrink:0}
  .dot.active{background:var(--accent)}
  .status-text{font-weight:600}
  .muted{color:var(--muted);font-size:.9rem}
</style>
</head>
<body>

<header>
  <h1>Foodie — Demo Online Ordering</h1>
  <div style="display:flex;gap:.75rem;align-items:center">
    <div id="userDisplay" class="small muted">Not logged in</div>
    <button id="btnLogin" class="secondary">Login / Register</button>
  </div>
</header>

<main class="container">
  <!-- LEFT: Restaurants -->
  <aside>
    <div class="card">
      <div class="search">
        <input id="searchInput" placeholder="Search restaurants or dishes..." />
        <button id="clearSearch" class="secondary">Clear</button>
      </div>
      <div id="restaurantsList" style="display:flex;flex-direction:column;gap:.5rem;max-height:60vh;overflow:auto"></div>
    </div>

    <div style="height:1rem"></div>

    <div class="card">
      <h4 style="margin:0 0 .5rem 0">Filters</h4>
      <div style="display:flex;gap:.5rem;flex-wrap:wrap">
        <button class="secondary" data-filter="all">All</button>
        <button class="secondary" data-filter="veg">Veg</button>
        <button class="secondary" data-filter="nonveg">Non-Veg</button>
        <button class="secondary" data-filter="rating4">Rating ≥ 4</button>
      </div>
    </div>
  </aside>

  <!-- MIDDLE: Menus -->
  <section class="menu-area">
    <div class="card">
      <div class="menu-header">
        <div>
          <div id="selectedRestName" style="font-weight:700">Select a restaurant</div>
          <div id="selectedRestDesc" class="small muted">Browse menus after selecting a restaurant</div>
        </div>
        <div class="row">
          <div class="badge" id="restMeta">—</div>
          <div style="width:.5rem"></div>
          <button id="viewOrders" class="secondary">My Orders</button>
        </div>
      </div>

      <div id="menuGrid" class="menu-grid">
        <!-- Dishes will be injected here -->
      </div>
    </div>
  </section>

  <!-- RIGHT: Cart -->
  <aside class="right-col">
    <div class="card cart">
      <h3>Cart</h3>
      <div id="cartItems" style="min-height:120px"></div>
      <div class="total-row">
        <div class="small">Subtotal</div>
        <div id="subtotal">₹0.00</div>
      </div>
      <div class="total-row">
        <div class="small">Delivery</div>
        <div id="delivery">₹40.00</div>
      </div>
      <div class="total-row" style="border-top:1px solid #eef1f6;padding-top:.75rem;margin-top:.5rem">
        <div>Total</div>
        <div id="total">₹0.00</div>
      </div>

      <div class="checkout">
        <button id="btnCheckout">Proceed to Payment</button>
        <button id="btnClear" class="secondary">Clear Cart</button>
      </div>
    </div>
  </aside>
</main>

<!-- Modals -->
<div id="modalBackdrop" class="modal-backdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" id="modalContent"></div>
</div>

<footer>
  This is a demo front-end — no real payments. Save as <strong>food-app.html</strong> and open in your browser.
</footer>

<script>
/* ======= Sample Data ======= */
const SAMPLE_RESTAURANTS = [
  {
    id: 'r1',
    name: "Spice Symphony",
    cuisine: "Indian • North",
    rating: 4.5,
    minOrder: 150,
    tags: ['veg'],
    dishes: [
      { id: 'd1', name: "Paneer Butter Masala", desc: "Creamy tomato gravy", price: 220, veg:true },
      { id: 'd2', name: "Garlic Naan (2)", desc: "Soft tandoori bread", price: 60, veg:true },
      { id: 'd3', name: "Chicken Biryani", desc: "Aromatic rice with spices", price: 260, veg:false },
    ]
  },
  {
    id: 'r2',
    name: "Green Bowl",
    cuisine: "Healthy • Salads",
    rating: 4.2,
    minOrder: 120,
    tags: ['veg'],
    dishes: [
      { id: 'd4', name: "Quinoa Salad", desc: "Quinoa, veggies, lemon", price: 180, veg:true },
      { id: 'd5', name: "Falafel Wrap", desc: "Chickpea falafels", price: 150, veg:true },
    ]
  },
  {
    id: 'r3',
    name: "Ocean's Catch",
    cuisine: "Seafood",
    rating: 4.7,
    minOrder: 200,
    tags: ['nonveg'],
    dishes: [
      { id: 'd6', name: "Grilled Salmon", desc: "Lemon herb glaze", price: 380, veg:false },
      { id: 'd7', name: "Prawn Curry", desc: "Coconut-based curry", price: 320, veg:false },
    ]
  }
];

/* ======= App State & Utilities ======= */
let state = {
  user: null, // {name,email}
  restaurants: SAMPLE_RESTAURANTS,
  selectedRestId: null,
  cart: JSON.parse(localStorage.getItem('cart_v1') || '{}'), // shape: {restId: {dishId: {dish, qty}}}
  orders: JSON.parse(localStorage.getItem('orders_v1') || '[]'), // list of past orders
};

function saveCart(){ localStorage.setItem('cart_v1', JSON.stringify(state.cart)); }
function saveOrders(){ localStorage.setItem('orders_v1', JSON.stringify(state.orders)); }
function formatRs(x){ return '₹' + Number(x).toFixed(2) }

/* ======= UI Rendering ======= */
const restaurantsList = document.getElementById('restaurantsList');
const menuGrid = document.getElementById('menuGrid');
const selectedRestName = document.getElementById('selectedRestName');
const selectedRestDesc = document.getElementById('selectedRestDesc');
const restMeta = document.getElementById('restMeta');
const cartItemsEl = document.getElementById('cartItems');
const subtotalEl = document.getElementById('subtotal');
const deliveryEl = document.getElementById('delivery');
const totalEl = document.getElementById('total');
const userDisplay = document.getElementById('userDisplay');

function renderRestaurants(filterText = '', filterTag = 'all'){
  restaurantsList.innerHTML = '';
  const q = filterText.trim().toLowerCase();
  state.restaurants.forEach(r => {
    if(filterTag === 'veg' && !r.tags.includes('veg')) return;
    if(filterTag === 'nonveg' && !r.tags.includes('nonveg')) return;
    if(filterTag === 'rating4' && r.rating < 4) return;
    const matches = !q || r.name.toLowerCase().includes(q) || r.cuisine.toLowerCase().includes(q) ||
      r.dishes.some(d => d.name.toLowerCase().includes(q));
    if(!matches) return;
    const el = document.createElement('div');
    el.className = 'restaurant';
    el.innerHTML = `
      <div class="rest-thumb">${r.name.split(' ').map(s=>s[0]).slice(0,2).join('')}</div>
      <div class="rest-meta">
        <div class="rest-name">${r.name}</div>
        <div class="rest-sub">${r.cuisine} · ⭐ ${r.rating}</div>
      </div>
      <div style="text-align:right;font-size:.9rem;color:var(--muted)">${formatRs(r.minOrder)}</div>
    `;
    el.addEventListener('click', ()=> selectRestaurant(r.id));
    restaurantsList.appendChild(el);
  });
}

function selectRestaurant(restId){
  state.selectedRestId = restId;
  const r = state.restaurants.find(x=>x.id===restId);
  selectedRestName.textContent = r.name;
  selectedRestDesc.textContent = ${r.cuisine} · Rating ${r.rating} · Min ₨${r.minOrder};
  restMeta.textContent = ${r.dishes.length} items;
  renderMenu(r);
}

function renderMenu(restaurant){
  menuGrid.innerHTML = '';
  restaurant.dishes.forEach(d=>{
    const card = document.createElement('div');
    card.className = 'dish';
    card.innerHTML = `
      <div class="title">
        <span>${d.name}</span>
        <span style="font-weight:700">${formatRs(d.price)}</span>
      </div>
      <p>${d.desc}</p>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="small">${d.veg ? 'Veg' : 'Non-veg'}</div>
        <div class="controls">
          <button class="secondary small" data-add="${d.id}">+ Add</button>
        </div>
      </div>
    `;
    menuGrid.appendChild(card);

    card.querySelector('[data-add]').addEventListener('click', ()=>{
      addToCart(restaurant.id, d);
    });
  });
}

/* ======= Cart Logic ======= */
function addToCart(restId, dish){
  if(!state.cart[restId]) state.cart[restId] = {};
  const entry = state.cart[restId][dish.id];
  if(entry) entry.qty += 1;
  else state.cart[restId][dish.id] = { dish, qty: 1 };
  saveCart();
  renderCart();
}

function updateQty(restId, dishId, qty){
  if(!state.cart[restId] || !state.cart[restId][dishId]) return;
  state.cart[restId][dishId].qty = qty;
  if(qty <= 0) delete state.cart[restId][dishId];
  if(Object.keys(state.cart[restId]).length === 0) delete state.cart[restId];
  saveCart();
  renderCart();
}

function clearCart(){
  state.cart = {};
  saveCart();
  renderCart();
}

function computeTotals(){
  let subtotal = 0;
  let delivery = 40;
  for(const restId in state.cart){
    for(const id in state.cart[restId]){
      const e = state.cart[res]()